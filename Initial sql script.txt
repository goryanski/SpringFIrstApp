CREATE DATABASE library;

CREATE TABLE people (
    id INT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    full_name VARCHAR(74) NOT NULL UNIQUE,
    email VARCHAR(48) NOT NULL UNIQUE,
    year INT NOT NULL CHECK(year > 1900)
);

INSERT INTO people(full_name, email, year)
VALUES
    ('Ivanov Igor Igorovich', 'igor@gmail.com', 1995),
    ('Petrov Ivan Ivanovich', 'ivan@gmail.com', 1990),
    ('Sidorova Maria Mitrofanovna', 'maria@gmail.com', 1988),
    ('Dan Bland', 'dan@gmail.com', 2000),
    ('Barbara Bull', 'barbara@gmail.com', 2004),
    ('Silas Lambert', 'silas@gmail.com', 1999);



CREATE TABLE books (
    id INT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    person_id INT REFERENCES people(id) ON DELETE SET NULL, -- if user deletes a person, person's books will be null (books will be released from the person automatically)
    name VARCHAR(200) NOT NULL,
    author VARCHAR(74) NOT NULL,
    year INT NOT NULL CHECK(year > 1000)
);

INSERT INTO books(person_id, name, author, year)
VALUES
    (1, 'The Lost Tribe', 'John Smyth', 1905),
    (2, 'How to Sew Buttons', 'Jane Do', 1991),
    (3, 'The Terrible Night', 'Eleanor Mellors', 1989),
    (2, 'Pizza and Donuts Diet', 'Heidi Holly', 2009),
    (1, '101 Cat House Plans', 'Bart Brat', 2007),
    (null, 'Land of Lemurs', 'Carol Sims', 2018), -- no one took this book
    (null, 'Last book', 'Tonny M', 1996); -- no one took this book